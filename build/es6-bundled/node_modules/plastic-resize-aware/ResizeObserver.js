(function(global,factory){"object"===typeof exports&&"undefined"!==typeof module?module.exports=factory():"function"===typeof define&&define.amd?define(factory):global.ResizeObserver=factory()})(this,function(){"use strict";var MapShim=function(){if("undefined"!==typeof Map){return Map}function getIndex(arr,key){var result=-1;arr.some(function(entry,index){if(entry[0]===key){result=index;return!0}return!1});return result}return function(){function anonymous(){this.__entries__=[]}var prototypeAccessors={size:{configurable:!0}};prototypeAccessors.size.get=function(){return this.__entries__.length};anonymous.prototype.get=function(key){var index=getIndex(this.__entries__,key),entry=this.__entries__[index];return entry&&entry[1]};anonymous.prototype.set=function(key,value){var index=getIndex(this.__entries__,key);if(~index){this.__entries__[index][1]=value}else{this.__entries__.push([key,value])}};anonymous.prototype.delete=function(key){var entries=this.__entries__,index=getIndex(entries,key);if(~index){entries.splice(index,1)}};anonymous.prototype.has=function(key){return!!~getIndex(this.__entries__,key)};anonymous.prototype.clear=function(){this.__entries__.splice(0)};anonymous.prototype.forEach=function(callback,ctx){var this$1=this;if(void 0===ctx)ctx=null;for(var i=0,list=this$1.__entries__,entry;i<list.length;i+=1){entry=list[i];callback.call(ctx,entry[1],entry[0])}};Object.defineProperties(anonymous.prototype,prototypeAccessors);return anonymous}()}(),isBrowser="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,global$1=function(){if("undefined"!==typeof global&&global.Math===Math){return global}if("undefined"!==typeof self&&self.Math===Math){return self}if("undefined"!==typeof window&&window.Math===Math){return window}return Function("return this")()}(),requestAnimationFrame$1=function(){if("function"===typeof requestAnimationFrame){return requestAnimationFrame.bind(global$1)}return function(callback){return setTimeout(function(){return callback(Date.now())},1e3/60)}}(),throttle=function(callback,delay){var leadingCall=!1,trailingCall=!1,lastCallTime=0;function resolvePending(){if(leadingCall){leadingCall=!1;callback()}if(trailingCall){proxy()}}function timeoutCallback(){requestAnimationFrame$1(resolvePending)}function proxy(){var timeStamp=Date.now();if(leadingCall){if(timeStamp-lastCallTime<2){return}trailingCall=!0}else{leadingCall=!0;trailingCall=!1;setTimeout(timeoutCallback,delay)}lastCallTime=timeStamp}return proxy},transitionKeys=["top","right","bottom","left","width","height","size","weight"],mutationObserverSupported="undefined"!==typeof MutationObserver,ResizeObserverController=function(){this.connected_=!1;this.mutationEventsAdded_=!1;this.mutationsObserver_=null;this.observers_=[];this.onTransitionEnd_=this.onTransitionEnd_.bind(this);this.refresh=throttle(this.refresh.bind(this),20)};ResizeObserverController.prototype.addObserver=function(observer){if(!~this.observers_.indexOf(observer)){this.observers_.push(observer)}if(!this.connected_){this.connect_()}};ResizeObserverController.prototype.removeObserver=function(observer){var observers=this.observers_,index=observers.indexOf(observer);if(~index){observers.splice(index,1)}if(!observers.length&&this.connected_){this.disconnect_()}};ResizeObserverController.prototype.refresh=function(){var changesDetected=this.updateObservers_();if(changesDetected){this.refresh()}};ResizeObserverController.prototype.updateObservers_=function(){var activeObservers=this.observers_.filter(function(observer){return observer.gatherActive(),observer.hasActive()});activeObservers.forEach(function(observer){return observer.broadcastActive()});return 0<activeObservers.length};ResizeObserverController.prototype.connect_=function(){if(!isBrowser||this.connected_){return}document.addEventListener("transitionend",this.onTransitionEnd_);window.addEventListener("resize",this.refresh);if(mutationObserverSupported){this.mutationsObserver_=new MutationObserver(this.refresh);this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}else{document.addEventListener("DOMSubtreeModified",this.refresh);this.mutationEventsAdded_=!0}this.connected_=!0};ResizeObserverController.prototype.disconnect_=function(){if(!isBrowser||!this.connected_){return}document.removeEventListener("transitionend",this.onTransitionEnd_);window.removeEventListener("resize",this.refresh);if(this.mutationsObserver_){this.mutationsObserver_.disconnect()}if(this.mutationEventsAdded_){document.removeEventListener("DOMSubtreeModified",this.refresh)}this.mutationsObserver_=null;this.mutationEventsAdded_=!1;this.connected_=!1};ResizeObserverController.prototype.onTransitionEnd_=function(ref){var propertyName=ref.propertyName;if(void 0===propertyName)propertyName="";var isReflowProperty=transitionKeys.some(function(key){return!!~propertyName.indexOf(key)});if(isReflowProperty){this.refresh()}};ResizeObserverController.getInstance=function(){if(!this.instance_){this.instance_=new ResizeObserverController}return this.instance_};ResizeObserverController.instance_=null;var defineConfigurable=function(target,props){for(var i=0,list=Object.keys(props),key;i<list.length;i+=1){key=list[i];Object.defineProperty(target,key,{value:props[key],enumerable:!1,writable:!1,configurable:!0})}return target},getWindowOf=function(target){var ownerGlobal=target&&target.ownerDocument&&target.ownerDocument.defaultView;return ownerGlobal||global$1},emptyRect=createRectInit(0,0,0,0);function toFloat(value){return parseFloat(value)||0}function getBordersSize(styles){var positions=[],len=arguments.length-1;while(0<len--)positions[len]=arguments[len+1];return positions.reduce(function(size,position){var value=styles["border-"+position+"-width"];return size+toFloat(value)},0)}function getPaddings(styles){for(var positions=["top","right","bottom","left"],paddings={},i=0,list=positions;i<list.length;i+=1){var position=list[i],value=styles["padding-"+position];paddings[position]=toFloat(value)}return paddings}function getSVGContentRect(target){var bbox=target.getBBox();return createRectInit(0,0,bbox.width,bbox.height)}function getHTMLElementContentRect(target){var _Mathabs=Math.abs,_Mathround=Math.round,clientWidth=target.clientWidth,clientHeight=target.clientHeight;if(!clientWidth&&!clientHeight){return emptyRect}var styles=getWindowOf(target).getComputedStyle(target),paddings=getPaddings(styles),horizPad=paddings.left+paddings.right,vertPad=paddings.top+paddings.bottom,width=toFloat(styles.width),height=toFloat(styles.height);if("border-box"===styles.boxSizing){if(_Mathround(width+horizPad)!==clientWidth){width-=getBordersSize(styles,"left","right")+horizPad}if(_Mathround(height+vertPad)!==clientHeight){height-=getBordersSize(styles,"top","bottom")+vertPad}}if(!isDocumentElement(target)){var vertScrollbar=_Mathround(width+horizPad)-clientWidth,horizScrollbar=_Mathround(height+vertPad)-clientHeight;if(1!==_Mathabs(vertScrollbar)){width-=vertScrollbar}if(1!==_Mathabs(horizScrollbar)){height-=horizScrollbar}}return createRectInit(paddings.left,paddings.top,width,height)}var isSVGGraphicsElement=function(){if("undefined"!==typeof SVGGraphicsElement){return function(target){return target instanceof getWindowOf(target).SVGGraphicsElement}}return function(target){return target instanceof getWindowOf(target).SVGElement&&"function"===typeof target.getBBox}}();function isDocumentElement(target){return target===getWindowOf(target).document.documentElement}function getContentRect(target){if(!isBrowser){return emptyRect}if(isSVGGraphicsElement(target)){return getSVGContentRect(target)}return getHTMLElementContentRect(target)}function createReadOnlyRect(ref){var x=ref.x,y=ref.y,width=ref.width,height=ref.height,Constr="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,rect=Object.create(Constr.prototype);defineConfigurable(rect,{x:x,y:y,width:width,height:height,top:y,right:x+width,bottom:height+y,left:x});return rect}function createRectInit(x,y,width,height){return{x:x,y:y,width:width,height:height}}var ResizeObservation=function(target){this.broadcastWidth=0;this.broadcastHeight=0;this.contentRect_=createRectInit(0,0,0,0);this.target=target};ResizeObservation.prototype.isActive=function(){var rect=getContentRect(this.target);this.contentRect_=rect;return rect.width!==this.broadcastWidth||rect.height!==this.broadcastHeight};ResizeObservation.prototype.broadcastRect=function(){var rect=this.contentRect_;this.broadcastWidth=rect.width;this.broadcastHeight=rect.height;return rect};var ResizeObserverEntry=function(target,rectInit){var contentRect=createReadOnlyRect(rectInit);defineConfigurable(this,{target:target,contentRect:contentRect})},ResizeObserverSPI=function(callback,controller,callbackCtx){this.activeObservations_=[];this.observations_=new MapShim;if("function"!==typeof callback){throw new TypeError("The callback provided as parameter 1 is not a function.")}this.callback_=callback;this.controller_=controller;this.callbackCtx_=callbackCtx};ResizeObserverSPI.prototype.observe=function(target){if(!arguments.length){throw new TypeError("1 argument required, but only 0 present.")}if("undefined"===typeof Element||!(Element instanceof Object)){return}if(!(target instanceof getWindowOf(target).Element)){throw new TypeError("parameter 1 is not of type \"Element\".")}var observations=this.observations_;if(observations.has(target)){return}observations.set(target,new ResizeObservation(target));this.controller_.addObserver(this);this.controller_.refresh()};ResizeObserverSPI.prototype.unobserve=function(target){if(!arguments.length){throw new TypeError("1 argument required, but only 0 present.")}if("undefined"===typeof Element||!(Element instanceof Object)){return}if(!(target instanceof getWindowOf(target).Element)){throw new TypeError("parameter 1 is not of type \"Element\".")}var observations=this.observations_;if(!observations.has(target)){return}observations.delete(target);if(!observations.size){this.controller_.removeObserver(this)}};ResizeObserverSPI.prototype.disconnect=function(){this.clearActive();this.observations_.clear();this.controller_.removeObserver(this)};ResizeObserverSPI.prototype.gatherActive=function(){var this$1=this;this.clearActive();this.observations_.forEach(function(observation){if(observation.isActive()){this$1.activeObservations_.push(observation)}})};ResizeObserverSPI.prototype.broadcastActive=function(){if(!this.hasActive()){return}var ctx=this.callbackCtx_,entries=this.activeObservations_.map(function(observation){return new ResizeObserverEntry(observation.target,observation.broadcastRect())});this.callback_.call(ctx,entries,ctx);this.clearActive()};ResizeObserverSPI.prototype.clearActive=function(){this.activeObservations_.splice(0)};ResizeObserverSPI.prototype.hasActive=function(){return 0<this.activeObservations_.length};var observers="undefined"!==typeof WeakMap?new WeakMap:new MapShim,ResizeObserver=function(callback){if(!(this instanceof ResizeObserver)){throw new TypeError("Cannot call a class as a function.")}if(!arguments.length){throw new TypeError("1 argument required, but only 0 present.")}var controller=ResizeObserverController.getInstance(),observer=new ResizeObserverSPI(callback,controller,this);observers.set(this,observer)};["observe","unobserve","disconnect"].forEach(function(method){ResizeObserver.prototype[method]=function(){return(ref=observers.get(this))[method].apply(ref,arguments);var ref}});var index=function(){if("undefined"!==typeof global$1.ResizeObserver){return global$1.ResizeObserver}global$1.ResizeObserver=ResizeObserver;return ResizeObserver}();return index});